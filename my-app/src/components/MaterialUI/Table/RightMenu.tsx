import { useState } from "react";
import { useLanguageContext } from "../../../context/LanguageContext";
import { IconButton, Stack } from "@mui/material";
import AddOutlinedIcon from "@mui/icons-material/AddOutlined";
import CustomModal from "../Modal";
import CustomTooltip from "../CustomTooltip";
import CreateForm from "../../AutoGeneratedForms/CreateForm";
import { Column, Configuration, Row } from "../../../Global/Types/commonTypes";
import { Query } from "../../../API/callApi";

interface RightMenuProps {
  columns: Column[];
  addNew?: boolean;
  configurations?: Configuration;
  title: string;
  setRows: React.Dispatch<React.SetStateAction<Row[]>>;
  createUrl: string;
  getQuery: Query;
}

const RightMenu: React.FC<RightMenuProps> = ({
  setRows,
  columns,
  addNew,
  configurations,
  title,
  createUrl,
  getQuery,
}) => {
  const { t } = useLanguageContext();

  const [modalTitle, setModalTitle] = useState<string | null>(null);
  return (
    <>
      <Stack alignItems="center">
        <Stack alignItems="center">
          <CustomTooltip title={t("Add")}>
            <IconButton
              aria-label={`${t("Add new")} ${title}`}
              onClick={() => setModalTitle("Add new")}
            >
              <AddOutlinedIcon />
            </IconButton>
          </CustomTooltip>
        </Stack>
      </Stack>
      {modalTitle && (
        <CustomModal
          open={!!modalTitle}
          onClose={() => setModalTitle(null)}
          title={`${t(modalTitle)} ${title}`}
          width={"lg"}
        >
          {modalTitle === "Add new" && addNew && columns.length !== 0 && (
            <CreateForm
              setFinalRows={setRows}
              columns={columns}
              configurations={configurations}
              actionUrl={createUrl}
              setModalTitle={setModalTitle}
              getQuery={getQuery}
            />
          )}
        </CustomModal>
      )}
    </>
  );
};

export default RightMenu;
